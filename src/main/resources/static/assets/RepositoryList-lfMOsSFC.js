import{_ as D}from"./TableHeader.vue_vue_type_script_setup_true_lang-273NJ1x7.js";import{_ as F}from"./Tabulator.vue_vue_type_style_index_0_lang-BNWSrmlZ.js";import{g as P,r as L,u as q,d as B,a as M}from"./repository-DAo-sqjF.js";import{d as x,u as $,c as A,w as S,o as V,r as v,a as C,b as e,t as R,e as d,g as w,m as _,h as N,n as T,i as g}from"./index-Z3I8BzbG.js";import"./request-BUVHrNac.js";const E={class:"modal",id:"repositoryForm",tabindex:"-1"},I={class:"modal-dialog modal-lg",role:"document"},G={class:"modal-content"},H=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),O={class:"modal-body text-left py-4"},j={class:"mb-5"},z={class:"row mb-3"},J=e("label",{class:"form-label required"},"Name",-1),K={class:"grid gap-0 column-gap-3"},Q=["disabled"],W={class:"mb-3"},X=e("label",{class:"form-label required"},"Format",-1),Y={class:"form-check form-check-inline"},Z=["disabled"],ee=e("span",{class:"form-check-label"},"raw",-1),te={class:"form-check form-check-inline"},oe=["disabled"],se=e("span",{class:"form-check-label"},"helm",-1),ae={class:"form-check form-check-inline"},le=["disabled"],ne=e("span",{class:"form-check-label"},"docker",-1),ie={class:"mb-3"},re=e("label",{class:"form-label required"},"Allow",-1),de={class:"form-check form-check-inline"},ce=e("span",{class:"form-check-label"},"allow",-1),me={class:"form-check form-check-inline"},ue=e("span",{class:"form-check-label"},"allow_once",-1),pe={class:"form-check form-check-inline"},_e=e("span",{class:"form-check-label"},"deny",-1),ve={class:"mb-3"},be=e("label",{class:"form-label required"},"On/Offline",-1),fe={class:"form-check form-check-inline"},he=e("span",{class:"form-check-label"},"true",-1),ye={class:"form-check form-check-inline"},ge=e("span",{class:"form-check-label"},"false",-1),ke=e("div",{class:"mb-3"},[e("label",{class:"form-label required"},"Storage"),e("div",{class:"grid gap-0 column-gap-3"},[e("input",{type:"text",class:"form-control p-2 g-col-11",value:"defalut",disabled:""})])],-1),we={class:"mb-3"},Re=e("label",{class:"form-label required"},"Http",-1),xe={class:"grid gap-0 column-gap-3"},$e=["disabled"],Ce={class:"mb-3"},Ne=e("label",{class:"form-label required"},"Https",-1),Ve={class:"grid gap-0 column-gap-3"},Ue=["disabled"],De={class:"modal-footer"},Fe=x({__name:"repositoryForm",props:{mode:{},repositoryName:{}},emits:["get-repository-list"],setup(y,{emit:f}){const c=$(),a=y,u=f,m=A(()=>a.repositoryName);S(m,async()=>{await i()}),V(async()=>{await i();const n=document.getElementById("repositoryForm");n==null||n.addEventListener("hidden.bs.modal",U)});const t=v({}),l=v(""),r=v(0),p=v(0),i=async()=>{if(a.mode==="new")t.value.name="",t.value.format="raw",t.value.type="hosted",t.value.url="",t.value.online=!0,r.value=0,p.value=0,l.value="allow";else{const{data:n}=await P("nexus",a.repositoryName);t.value=n,l.value=n.storage.writePolicy,n.format=="docker"&&(r.value=n.docker.httpPort,p.value=n.docker.httpsPort)}},b=async()=>{t.value.storage={blobStoreName:"default",strictContentTypeValidation:!0,writePolicy:l.value},t.value.format!="docker"?t.value.docker=null:t.value.docker={v1Enabled:!0,forceBasicAuth:!0,httpPort:r.value,httpsPort:p.value,subdomain:"/test"},a.mode==="new"?await h().then(()=>{u("get-repository-list")}):await k().then(()=>{u("get-repository-list")}),i()},h=async()=>{const{data:n}=await L("nexus",t.value);n?c.success("등록되었습니다."):c.error("등록 할 수 없습니다.")},k=async()=>{const{data:n}=await q("nexus",t.value);n?c.success("등록되었습니다."):c.error("등록 할 수 없습니다.")},U=()=>{t.value.name="",t.value.format="raw",t.value.type="hosted",t.value.url="",t.value.online=!0,r.value=0,p.value=0,l.value="allow"};return(n,o)=>(N(),C("div",E,[e("div",I,[e("div",G,[H,e("div",O,[e("h3",j," Repository "+R(a.mode==="new"?"생성":"수정"),1),e("div",null,[e("div",z,[J,e("div",K,[d(e("input",{type:"text",class:"form-control p-2 g-col-11","onUpdate:modelValue":o[0]||(o[0]=s=>t.value.name=s),disabled:a.mode!="new"},null,8,Q),[[w,t.value.name]])])]),e("div",W,[X,e("div",null,[e("label",Y,[d(e("input",{class:"form-check-input",type:"radio",name:"format",value:"raw","onUpdate:modelValue":o[1]||(o[1]=s=>t.value.format=s),disabled:a.mode!="new"},null,8,Z),[[_,t.value.format]]),ee]),e("label",te,[d(e("input",{class:"form-check-input",type:"radio",name:"format",value:"helm","onUpdate:modelValue":o[2]||(o[2]=s=>t.value.format=s),disabled:a.mode!="new"},null,8,oe),[[_,t.value.format]]),se]),e("label",ae,[d(e("input",{class:"form-check-input",type:"radio",name:"format",value:"docker","onUpdate:modelValue":o[3]||(o[3]=s=>t.value.format=s),disabled:a.mode!="new"},null,8,le),[[_,t.value.format]]),ne])])]),e("div",ie,[re,e("div",null,[e("label",de,[d(e("input",{class:"form-check-input",type:"radio",name:"allow",value:"allow","onUpdate:modelValue":o[4]||(o[4]=s=>l.value=s)},null,512),[[_,l.value]]),ce]),e("label",me,[d(e("input",{class:"form-check-input",type:"radio",name:"allow",value:"allow_once","onUpdate:modelValue":o[5]||(o[5]=s=>l.value=s)},null,512),[[_,l.value]]),ue]),e("label",pe,[d(e("input",{class:"form-check-input",type:"radio",name:"allow",value:"deny","onUpdate:modelValue":o[6]||(o[6]=s=>l.value=s)},null,512),[[_,l.value]]),_e])])]),e("div",ve,[be,e("div",null,[e("label",fe,[d(e("input",{class:"form-check-input",type:"radio",name:"online",value:"true","onUpdate:modelValue":o[7]||(o[7]=s=>t.value.online=s)},null,512),[[_,t.value.online]]),he]),e("label",ye,[d(e("input",{class:"form-check-input",type:"radio",name:"online",value:"false","onUpdate:modelValue":o[8]||(o[8]=s=>t.value.online=s)},null,512),[[_,t.value.online]]),ge])])]),ke,e("div",we,[Re,e("div",xe,[d(e("input",{type:"text",class:"form-control p-2 g-col-11","onUpdate:modelValue":o[9]||(o[9]=s=>r.value=s),disabled:t.value.format!="docker"},null,8,$e),[[w,r.value]])])]),e("div",Ce,[Ne,e("div",Ve,[d(e("input",{type:"text",class:"form-control p-2 g-col-11","onUpdate:modelValue":o[10]||(o[10]=s=>p.value=s),disabled:t.value.format!="docker"},null,8,Ue),[[w,p.value]])])])])]),e("div",De,[e("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal",onClick:o[11]||(o[11]=s=>i())}," Cancel "),e("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:o[12]||(o[12]=s=>b())},R(a.mode==="new"?"생성":"수정"),1)])])])]))}}),Pe={class:"modal",id:"deleteRepository",tabindex:"-1"},Le={class:"modal-dialog modal-lg",role:"document"},qe={class:"modal-content"},Be=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Me=e("div",{class:"modal-status bg-danger"},null,-1),Ae={class:"modal-body text-left py-4"},Se=e("h3",{class:"mb-5"}," Repository 삭제 ",-1),Te={class:"modal-footer"},Ee=e("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal"}," Cancel ",-1),Ie=x({__name:"deleteRepository",props:{repositoryName:{}},emits:["get-repository-list"],setup(y,{emit:f}){const c=$(),a=y,u=f,m=async()=>{const{data:t}=await B("nexus",a.repositoryName);t?c.success("삭제되었습니다."):c.error("삭제하지 못했습니다."),u("get-repository-list")};return(t,l)=>(N(),C("div",Pe,[e("div",Le,[e("div",qe,[Be,Me,e("div",Ae,[Se,e("h4",null,R(a.repositoryName)+"을(를) 정말 삭제하시겠습니까?",1)]),e("div",Te,[Ee,e("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:l[0]||(l[0]=r=>m())}," 삭제 ")])])])]))}}),Ge={class:"card card-flush w-100"},Ke=x({__name:"RepositoryList",setup(y){const f=$(),c=v([]),a=v([]);V(async()=>{t(),await u()});const u=async()=>{try{const{data:i}=await M("nexus");c.value=i}catch(i){console.log(i),f.error("데이터를 가져올 수 없습니다.")}},m=v(""),t=()=>{a.value=[{title:"Name",field:"name",width:400,cellClick:function(i,b){i.stopPropagation(),m.value=b.getRow().getData().name,T.push("/web/repository/detail/"+m.value)}},{title:"Format",field:"format",width:300},{title:"URL",field:"url",width:410},{title:"Type(hosted)",field:"type",width:400},{title:"Action",width:400,formatter:l,cellClick:function(i,b){const h=i.target,k=h==null?void 0:h.getAttribute("id");m.value=b.getRow().getData().name,k==="edit-btn"?r.value="edit":m.value=b.getRow().getData().name}}]},l=()=>`
  <div>
    <button
      class='btn btn-primary d-none d-sm-inline-block mr-5'
      id='edit-btn'
      data-bs-toggle='modal' 
      data-bs-target='#repositoryForm'>
      Update
    </button>
    <button
      class='btn btn-danger d-none d-sm-inline-block'
      id='delete-btn'
      data-bs-toggle='modal' 
      data-bs-target='#deleteRepository'>
      Delete
    </button>
  </div>`,r=v("new"),p=()=>{r.value="new"};return(i,b)=>(N(),C("div",Ge,[g(D,{"header-title":"Repository","new-btn-title":"New Repository","popup-flag":!0,"popup-target":"#repositoryForm",onClickNewBtn:p}),g(F,{columns:a.value,"table-data":c.value},null,8,["columns","table-data"]),g(Fe,{mode:r.value,"repository-name":m.value,onGetRepositoryList:u},null,8,["mode","repository-name"]),g(Ie,{"repository-name":m.value,onGetRepositoryList:u},null,8,["repository-name"])]))}});export{Ke as default};
