import{c as U}from"./IconPlus-cRLNI5Qz.js";import{r as Y,a as J,g as Q,b as W,S as X,s as Z,c as tt,I as O,A as st}from"./softwareCatalogForm-C9hf16Iw.js";import{_ as at}from"./Tabulator.vue_vue_type_style_index_0_lang-AyImqkUy.js";import{d as E,u as K,c as B,r as c,h as i,a as l,b as t,q as R,t as r,j as T,e as z,g as q,o as j,i as h,s as A,F as $,f as x,x as ot,y as et,l as nt}from"./index-BHIrf46W.js";import{_ as it}from"./lodash-BWE95Lgt.js";import{_ as lt}from"./RepositoryList.vue_vue_type_script_setup_true_lang-CsCsVIqs.js";import"./request-FBsUrWrl.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-DulTAMyI.js";import"./repository-Cc5uirx3.js";/**
 * @license @tabler/icons-vue v3.21.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ct=U("outline","activity-heartbeat","IconActivityHeartbeat",[["path",{d:"M3 12h4.5l1.5 -6l4 12l2 -9l1.5 3h4.5",key:"svg-0"}]]);/**
 * @license @tabler/icons-vue v3.21.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var dt=U("outline","apps","IconApps",[["path",{d:"M4 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M4 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-1"}],["path",{d:"M14 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M14 7l6 0",key:"svg-3"}],["path",{d:"M17 4l0 6",key:"svg-4"}]]);/**
 * @license @tabler/icons-vue v3.21.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var rt=U("outline","folder","IconFolder",[["path",{d:"M5 4h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2",key:"svg-0"}]]);/**
 * @license @tabler/icons-vue v3.21.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ut=U("outline","refresh","IconRefresh",[["path",{d:"M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4",key:"svg-0"}],["path",{d:"M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4",key:"svg-1"}]]);const pt={class:"modal",id:"action-confirm",tabindex:"-1"},ht={class:"modal-dialog modal-lg",role:"document"},_t={class:"modal-content"},mt={class:"modal-header"},vt={class:"modal-title"},gt={key:0},bt={class:"modal-body",style:{"max-height":"calc(100vh - 200px)","overflow-y":"auto"}},ft={class:"mb-3"},yt=t("label",{class:"form-label"},"Reason",-1),wt=t("p",{class:"text-muted"}," Please enter a reason ",-1),kt={class:"modal-footer d-flex justify-content-between"},St=E({__name:"applicationActionConfirm",props:{title:{},applicationStatusId:{},type:{},applicationName:{}},emits:["getApplicationsStatusList"],setup(L,{emit:y}){const u=K(),_=L,b=y,p=B(()=>_.title),f=B(()=>_.applicationStatusId),d=B(()=>_.type),m=c(""),v=()=>{m.value=""},I=async()=>{v();let w;const g={operation:p.value,applicationStatusId:f.value,reason:m.value};if(d.value==="VM"){const{data:k}=await Y(g);w=k}else if(d.value==="K8S"){const{data:k}=await J(g);w=k}b("getApplicationsStatusList"),w?u.success(`${p.value} Action SUCCESS`):u.error(`${p.value} Action FAIL`)};return(w,g)=>(i(),l("div",pt,[t("div",ht,[t("div",_t,[t("div",mt,[t("h5",vt,[R(r(w.applicationName)+" "+r(p.value)+" ",1),d.value?(i(),l("span",gt,"("+r(d.value)+")",1)):T("",!0)]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:v})]),t("div",bt,[t("div",ft,[yt,wt,z(t("textarea",{class:"form-control",rows:"10",placeholder:"Reason","onUpdate:modelValue":g[0]||(g[0]=k=>m.value=k)},null,512),[[q,m.value]])])]),t("div",kt,[t("a",{class:"btn btn-link link-secondary","data-bs-dismiss":"modal",onClick:v}," Cancel "),t("div",null,[t("button",{class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:I},r(p.value),1)])])])])]))}}),$t={class:"d-flex justify-content-between"},Ct=t("h2",null,"Apps Status",-1),At={class:"me-1"},It={class:"card card-flush w-100"},Tt=E({__name:"applicationStatusList",setup(L){const y=K(),u=c([]),_=c([]),b=c(""),p=c(""),f=c(0),d=c(""),m=c("");j(async()=>{w(),await v()});const v=async()=>{try{I();const{data:o}=await Q();o?u.value=o:u.value=[]}catch(o){console.log(o),y.error("Unable to retrieve data")}},I=()=>{u.value=[];const o=new Date,n={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1};b.value=o.toLocaleDateString("ko-KR",n)},w=()=>{_.value=[{title:"Type",field:"deploymentType",width:"10%"},{title:"Application",field:"applicationName",width:"20%"},{title:"Infra",width:"15%",formatter:k},{title:"Status",width:"15%",formatter:G},{title:"CheckedAt",field:"checkedAt",width:"20%"},{title:"Action",width:"20%",formatter:M,cellClick:async function(o,n){const N=o.target,D=N==null?void 0:N.getAttribute("id"),H=n.getRow().getData().id,V=n.getRow().getData().deploymentType,F=n.getRow().getData().applicationName,s={operation:"",applicationStatusId:H,deploymentType:V,applicationName:F};D==="restart-btn"?(s.operation="RESTART",await g(s)):D==="stop-btn"?(s.operation="STOP",await g(s)):D==="uninstall-btn"&&(s.operation="UNINSTALL",await g(s))}}]},g=async o=>{p.value=o.operation,f.value=o.applicationStatusId,d.value=o.deploymentType,m.value=o.applicationName},k=o=>`
    <div>
      <p>
        ${o.getRow().getData().vmName?o.getRow().getData().vmName:o.getRow().getData().clusterName?o.getRow().getData().clusterName:"-"}
      <p>
    </div>
  `,G=o=>{const n=o.getRow().getData().status;return n==="RUNNING"?`
      <div>
        <span class="status status-green">  
          <span class="status-dot"></span>
            ${n}
        </span>
      </div>`:n==="RESTART"||n==="IN_PROGRESS"?`
    <div>
      <span class="status status-primary">  
        <span class="status-dot"></span>
          ${n}
      </span>
    </div>`:n==="NOT_FOUND"?`
    <div>
      <span class="status status-yellow">  
        <span class="status-dot"></span>
          ${n}
      </span>
    </div>`:`
  <div>
    <span class="status status-red">  
      <span class="status-dot"></span>
        ${n}
    </span>
  </div>`},M=()=>`
  <div>
    <button
      class='btn btn-ghost-primary d-none d-sm-inline-block'
      id='restart-btn'
      data-bs-toggle='modal' 
      data-bs-target='#action-confirm'>
      Restart
    </button>
    <button
      class='btn btn-ghost-warning d-none d-sm-inline-block'
      id='stop-btn'
      data-bs-toggle='modal' 
      data-bs-target='#action-confirm'>
      Stop
    </button>
    <button
      class='btn btn-ghost-danger d-none d-sm-inline-block'
      id='uninstall-btn'
      data-bs-toggle='modal' 
      data-bs-target='#action-confirm'>
      Uninstall
    </button>
  </div>`;return(o,n)=>(i(),l($,null,[t("div",null,[t("div",$t,[Ct,t("div",null,[t("span",At,r(b.value),1),h(A(ut),{class:"cursor-pointer",onClick:v})])]),t("div",It,[h(at,{columns:_.value,"table-data":u.value},null,8,["columns","table-data"])])]),h(St,{title:p.value,applicationStatusId:f.value,type:d.value,applicationName:m.value,onGetApplicationsStatusList:v},null,8,["title","applicationStatusId","type","applicationName"])],64))}}),Nt={ref:"sofwareCatalog"},Dt=t("h2",null,"Catalog",-1),xt={class:"row"},Rt={class:"col-lg-9"},Lt={class:"card"},Mt={class:"list-group card-list-group",id:"sc-list-group"},Ht={class:"row g-2 align-items-center"},Ut={class:"col-auto me-3"},Et=["src"],Gt=["onClick"],Vt={class:"text-muted"},Ft={class:"col-auto text-muted"},Pt={class:"col-auto lh-1"},Ot={class:"dropdown"},Bt={href:"#",class:"link-secondary","data-bs-toggle":"dropdown"},Kt={class:"dropdown-menu dropdown-menu-end"},jt=["onClick"],zt=["id"],qt={class:"accordion-body pt-0"},Yt=["innerHTML"],Jt=t("strong",null,"Ref Information",-1),Qt=["id"],Wt=["onClick"],Xt=t("strong",null,"TAGS",-1),Zt=["id"],ts=t("strong",null,"Recommended Spec",-1),ss=["id"],as={class:"btn btn-sm",style:{"margin-right":"5px"}},os={class:"btn btn-sm",style:{"margin-right":"5px"}},es={class:"btn btn-sm",style:{"margin-right":"5px"}},ns={class:"col-lg-3"},is=t("h3",{class:"mb-3"}," dockerHub search ",-1),ls={key:0,class:"col-md-6 col-lg-12",id:"resultDockerHubEmpty"},cs={class:"row row-cards",id:"resultDockerHubSearch"},ds={class:"card"},rs={class:"row row-0"},us={class:"col-auto"},ps=["src"],hs={class:"col"},_s={class:"card-body"},ms={href:"",target:"_blank"},vs={class:"text-muted"},gs={class:"col-auto lh-1"},bs={class:"dropdown"},fs={href:"#",class:"link-secondary","data-bs-toggle":"dropdown"},ys={class:"dropdown-menu dropdown-menu-end"},ws=["onClick"],ks=t("a",{class:"dropdown-item",href:"#"}," Copy file/image to repository ",-1),Ss={class:"mt-5"},$s=t("h3",{class:"mb-3"}," artifactHub search ",-1),Cs={key:0,class:"col-md-6 col-lg-12",id:"resultArtifactHubEmpty"},As={class:"row row-cards",id:"resultArtifactHubSearch"},Is={class:"card"},Ts={class:"row row-0"},Ns=t("div",{class:"col-auto"},[t("img",{src:"https://artifacthub.io/static/media/placeholder_pkg_helm.png",class:"rounded-start",alt:"Shape of You",width:"80",height:"80"})],-1),Ds={class:"col"},xs={class:"card-body"},Rs={href:"",target:"_blank"},Ls={class:"text-muted"},Ms={class:"col-auto lh-1"},Hs={class:"dropdown"},Us={href:"#",class:"link-secondary","data-bs-toggle":"dropdown"},Es={class:"dropdown-menu dropdown-menu-end"},Gs=["onClick"],Vs=t("a",{class:"dropdown-item",href:"#"}," Copy file/image to repository ",-1),Fs=E({__name:"softwareCatalogList",setup(L){const y=K(),u=c([]),_=c(null),b=c("new"),p=c({}),f=c(""),d=c(""),m=c([]),v=c([]);j(async()=>{d.value="",I()});const I=async()=>{try{await W(d.value).then(({data:s})=>{it.forEach(s,function(e){e.refData=w(e.catalogRefs),e.isShow=!1}),u.value=s})}catch(s){console.log(s),y.error("Unable to retrieve data.")}},w=s=>s.reduce((e,a)=>(e[a.refType]||(e[a.refType]=[]),e[a.refType].push(a),e),{}),g=async s=>{s.keyCode==13&&(await k(),await G())},k=async()=>{m.value=[];try{const{data:s}=await Z(d.value);for(let e=0;e<3;e++)m.value.push(s.results[e])}catch(s){console.log(s),y.error("Unable to retrieve data.")}},G=async()=>{v.value=[];try{const{data:s}=await tt(d.value);for(let e=0;e<3;e++)v.value.push(s.packages[e])}catch(s){console.log(s),y.error("Unable to retrieve data.")}},M=(s,e)=>{b.value="new",_.value=0,p.value=e,f.value=s},o=s=>{b.value="update",_.value=s},n=()=>{let s=`https://hub.docker.com/search?q=${d.value}`;window.open(s,"_blank")},N=()=>{let s=`https://artifacthub.io/packages/search?ts_query_web=${d.value}&sort=relevance&page=1`;window.open(s,"_blank")},D=async s=>{u.value[s].isShow=!u.value[s].isShow},H=(s,e)=>Object.prototype.hasOwnProperty.call(s,e),V=s=>{window.open(s)},F=s=>s.replace(/\\n|\n/g,"<br/>");return(s,e)=>(i(),l($,null,[t("div",Nt,[Dt,t("div",xt,[t("div",Rt,[t("div",Lt,[t("div",Mt,[(i(!0),l($,null,x(u.value,(a,S)=>(i(),l("div",{class:"list-group-item",key:S},[t("div",Ht,[t("div",Ut,[t("img",{src:a.logoUrlLarge,class:"rounded",alt:"Catalog Icon",width:"40",height:"40"},null,8,Et)]),t("div",{class:"col",onClick:C=>D(S)},[R(r(a.title)+" ",1),t("div",Vt,r(a.summary),1)],8,Gt),t("div",Ft,r(a.category),1),t("div",Pt,[t("div",Ot,[t("a",Bt,[h(A(O),{class:"icon",width:"24",height:"24","stroke-width":"2"})]),t("div",Kt,[t("a",{class:"dropdown-item",onClick:C=>o(a.id),"data-bs-toggle":"modal","data-bs-target":"#modal-form"}," Update ",8,jt)])])]),t("div",{id:"accordion_"+a.id,class:"accordion-collapse collapse",style:ot([a.isShow?{display:"block"}:{display:"none"}])},[t("div",qt,[t("div",{class:"mt-3 mb-5",innerHTML:F(a.description)},null,8,Yt),t("div",null,[Jt,t("ul",{id:`${S}-entity-ul`},[H(a.refData,"HOMEPAGE")?(i(!0),l($,{key:0},x(a.refData.HOMEPAGE,(C,P)=>(i(),l("li",{key:P},[t("a",{class:"btn",onClick:ra=>V(C.refValue)},r(C.refValue),9,Wt)]))),128)):T("",!0)],8,Qt),Xt,t("ul",{id:`${S}-tag-ul`},[H(a.refData,"TAG")?(i(!0),l($,{key:0},x(a.refData.TAG,(C,P)=>(i(),l("span",{key:P},"#"+r(C.refValue)+"  ",1))),128)):T("",!0)],8,Zt),ts,t("ul",{id:`${S}-tag-ul`},[a.recommendedCpu&&a.recommendedMemory&&a.recommendedDisk?(i(),l($,{key:0},[t("button",as," CPU : "+r(a.recommendedCpu)+" Core ",1),t("button",os," MEMORY : "+r(a.recommendedMemory)+" GB ",1),t("button",es," DISK : "+r(a.recommendedDisk)+" GB ",1)],64)):T("",!0)],8,ss)])])],12,zt)])]))),128))])])]),t("div",ns,[z(t("input",{type:"text",class:"form-control mb-3",placeholder:"Search…",onKeypress:g,"onUpdate:modelValue":e[0]||(e[0]=a=>d.value=a),id:"inputCatalogSearch"},null,544),[[q,d.value]]),is,m.value.length==0?(i(),l("div",ls," There are no related Container Images found. ")):T("",!0),t("div",cs,[(i(!0),l($,null,x(m.value,(a,S)=>(i(),l("div",{class:"col-md-6 col-lg-12",key:S},[t("div",ds,[t("div",rs,[t("div",us,[t("img",{src:a.logo_url.large,class:"rounded-start",alt:"Shape of You",width:"80",height:"80"},null,8,ps)]),t("div",hs,[t("div",_s,[t("a",ms,r(a.name),1),t("div",vs,r(a.short_description.length>30?a.short_description.substring(0,30)+"...":""),1)])]),t("div",gs,[t("div",bs,[t("a",fs,[h(A(O),{class:"icon",size:"24","stroke-width":"2"})]),t("div",ys,[t("a",{class:"dropdown-item",onClick:n}," Go to the page "),t("a",{class:"dropdown-item",href:"#","data-bs-toggle":"modal","data-bs-target":"#modal-form",onClick:C=>M("dockerhub",a)}," Enter content into softwareCatalog ",8,ws),ks])])])])])]))),128))]),t("div",Ss,[$s,v.value.length==0?(i(),l("div",Cs," There are no related Helm Charts found. ")):T("",!0),t("div",As,[(i(!0),l($,null,x(v.value,(a,S)=>(i(),l("div",{class:"col-md-6 col-lg-12",key:S},[t("div",Is,[t("div",Ts,[Ns,t("div",Ds,[t("div",xs,[t("a",Rs,r(a.name),1),t("div",Ls,r(a.description.length>30?a.description.substring(0,30)+"...":""),1)])]),t("div",Ms,[t("div",Hs,[t("a",Us,[h(A(O),{class:"icon",width:"24",height:"24","stroke-width":"2"})]),t("div",Es,[t("a",{class:"dropdown-item",onClick:N}," Go to the page "),t("a",{class:"dropdown-item",href:"#","data-bs-toggle":"modal","data-bs-target":"#modal-form",onClick:C=>M("artifacthub",a)}," Enter content into softwareCatalog ",8,Gs),Vs])])])])])]))),128))])])])])],512),h(X,{mode:b.value,"catalog-idx":_.value,"repository-application-info":p.value,"repository-name":f.value,onGetList:I},null,8,["mode","catalog-idx","repository-application-info","repository-name"])],64))}}),Ps={class:"page",ref:"sofwareCatalog"},Os={class:"page-wrapper"},Bs=nt('<div class="page-header d-print-none"><div class="container-xxl"><div class="row g-2 align-items-center"><div class="col d-flex"><h2 class="page-title">Software catalog</h2></div></div></div></div>',1),Ks={class:"page-body"},js={class:"container-xxl"},zs={class:"row"},qs={class:"col-lg-12"},Ys={class:"col-auto me-auto fs-3"},Js={class:"d-flex justify-content-end"},Qs={class:"card"},Ws={class:"card-header"},Xs={class:"nav nav-tabs card-header-tabs","data-bs-toggle":"tabs"},Zs={class:"nav-item"},ta={href:"#tabs-catalog",class:"nav-link active","data-bs-toggle":"tab"},sa={class:"nav-item"},aa={href:"#tabs-status",class:"nav-link","data-bs-toggle":"tab"},oa={class:"nav-item"},ea={href:"#tabs-repository",class:"nav-link","data-bs-toggle":"tab"},na={class:"card-body"},ia={class:"tab-content"},la={class:"tab-pane active show",id:"tabs-catalog"},ca={class:"tab-pane",id:"tabs-status"},da={class:"tab-pane",id:"tabs-repository"},wa=E({__name:"SoftwareCatalog",setup(L){const y=et(),u=c(""),_=c("");j(async()=>{u.value=y.getNsId()});const b=p=>{_.value=p};return(p,f)=>(i(),l($,null,[t("div",Ps,[t("div",Os,[Bs,t("div",Ks,[t("div",js,[t("div",zs,[t("div",qs,[t("div",Ys,[t("div",Js,[t("button",{class:"btn btn-primary me-md-2 mb-2","data-bs-toggle":"modal","data-bs-target":"#install-form",onClick:f[0]||(f[0]=d=>b("Application Installation"))},"INSTALL")])]),t("div",Qs,[t("div",Ws,[t("ul",Xs,[t("li",Zs,[t("a",ta,[h(A(dt),{class:"icon me-2",width:"24",height:"24","stroke-width":"2"}),R(" Catalog ")])]),t("li",sa,[t("a",aa,[h(A(ct),{class:"icon me-2",width:"24",height:"24","stroke-width":"2"}),R(" Apps Status ")])]),t("li",oa,[t("a",ea,[h(A(rt),{class:"icon me-2",width:"24",height:"24","stroke-width":"2"}),R(" Repository ")])])])]),t("div",na,[t("div",ia,[t("div",la,[t("div",null,[h(Fs,{nsId:u.value},null,8,["nsId"])])]),t("div",ca,[t("div",null,[h(Tt)])]),t("div",da,[t("div",null,[h(lt)])])])])])])])])])])],512),h(st,{"ns-id":u.value,title:_.value},null,8,["ns-id","title"])],64))}});export{wa as default};
