import{M as D,_ as T}from"./bootstrap.esm-a0ldWJHp.js";import{_ as $}from"./Tabulator.vue_vue_type_style_index_0_lang-Dc-G6KLn.js";import{g as q,r as L,b as B,c as E,e as S}from"./repository-BVZXHKt_.js";import{d as P,u as C,r as c,c as A,w as H,o as N,a as U,b as e,t as R,e as m,g as _,z as b,h as x,A as M,i as g}from"./index-DzJ3jzpJ.js";const I={class:"modal-dialog modal-lg",role:"document"},G={class:"modal-content"},O={class:"modal-header"},z={class:"modal-title"},j={class:"modal-body py-4"},J={class:"row mb-3"},K=["disabled"],Q={class:"mb-3"},W={class:"form-check form-check-inline"},X=["disabled"],Y={class:"form-check form-check-inline"},Z=["disabled"],ee={class:"form-check form-check-inline"},te=["disabled"],oe={class:"mb-3"},le={class:"form-check form-check-inline"},se={class:"form-check form-check-inline"},ae={class:"form-check form-check-inline"},re={class:"mb-3"},ne={class:"form-check form-check-inline"},ie={class:"form-check form-check-inline"},de={class:"mb-3"},ue={class:"grid gap-0 column-gap-3"},me=["disabled"],ce={class:"mb-3"},pe={class:"grid gap-0 column-gap-3"},fe=["disabled"],ve={class:"modal-footer"},be=P({__name:"repositoryForm",props:{mode:{},repositoryName:{}},emits:["get-repository-list"],setup(w,{emit:k}){const a=C(),p=c(),f=c(),s=w,y=k,i=A(()=>s.repositoryName);H(i,async()=>{await v()}),N(async()=>{p.value&&(f.value=new D(p.value)),await v()});const o=c({}),u=c(""),r=c(0),d=c(0),v=async()=>{if(s.mode==="new")o.value.name="",o.value.format="raw",o.value.type="hosted",o.value.url="",o.value.online=!0,r.value=0,d.value=0,u.value="allow";else{const{data:n}=await q("nexus",s.repositoryName);o.value=n,u.value=n.storage.writePolicy,n.format=="docker"&&(r.value=n.docker.httpPort,d.value=n.docker.httpsPort)}},h=async()=>{if(!o.value.name||o.value.name.trim()===""){a.error("Please enter repository name.");return}if(!o.value.format){a.error("Please select format.");return}if(!u.value){a.error("Please select allow policy.");return}if(o.value.online===void 0||o.value.online===null){a.error("Please select online/offline status.");return}if(o.value.format==="docker"){if(!r.value||r.value<=0){a.error("Please enter valid HTTP port.");return}if(!d.value||d.value<=0){a.error("Please enter valid HTTPS port.");return}}o.value.storage={blobStoreName:"default",strictContentTypeValidation:!0,writePolicy:u.value},o.value.format!="docker"?o.value.docker={}:o.value.docker={v1Enabled:!0,forceBasicAuth:!0,httpPort:r.value,httpsPort:d.value,subdomain:"/test"};let n=!1;s.mode==="new"?n=await F():n=await V(),n&&(y("get-repository-list"),v(),f.value&&(f.value.hide(),setTimeout(()=>{document.body.classList.remove("modal-open");const t=document.querySelector(".modal-backdrop");t==null||t.remove()},150)))},F=async()=>{try{const{data:n}=await L("nexus",o.value);return n?(a.success("Repository created successfully."),!0):(a.error("Failed to create repository."),!1)}catch{return a.error("Failed to create repository."),!1}},V=async()=>{try{const{data:n}=await B("nexus",o.value);return n?(a.success("Repository updated successfully."),!0):(a.error("Failed to update repository."),!1)}catch{return a.error("Failed to update repository."),!1}};return(n,t)=>(x(),U("div",{class:"modal fade",id:"repositoryForm",tabindex:"-1",ref_key:"modalElement",ref:p},[e("div",I,[e("div",G,[e("div",O,[e("h3",z,"Repository "+R(s.mode==="new"?"Create":"Update"),1),t[13]||(t[13]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),e("div",j,[e("div",null,[e("div",J,[t[14]||(t[14]=e("label",{class:"form-label required"},"Name",-1)),m(e("input",{type:"text",class:"form-control p-2 g-col-11","onUpdate:modelValue":t[0]||(t[0]=l=>o.value.name=l),disabled:s.mode!="new",placeholder:"Enter repository name"},null,8,K),[[_,o.value.name]])]),e("div",Q,[t[18]||(t[18]=e("label",{class:"form-label required"},"Format",-1)),e("div",null,[e("label",W,[m(e("input",{class:"form-check-input",type:"radio",name:"format",value:"raw","onUpdate:modelValue":t[1]||(t[1]=l=>o.value.format=l),disabled:s.mode!="new"},null,8,X),[[b,o.value.format]]),t[15]||(t[15]=e("span",{class:"form-check-label"},"raw",-1))]),e("label",Y,[m(e("input",{class:"form-check-input",type:"radio",name:"format",value:"helm","onUpdate:modelValue":t[2]||(t[2]=l=>o.value.format=l),disabled:s.mode!="new"},null,8,Z),[[b,o.value.format]]),t[16]||(t[16]=e("span",{class:"form-check-label"},"helm",-1))]),e("label",ee,[m(e("input",{class:"form-check-input",type:"radio",name:"format",value:"docker","onUpdate:modelValue":t[3]||(t[3]=l=>o.value.format=l),disabled:s.mode!="new"},null,8,te),[[b,o.value.format]]),t[17]||(t[17]=e("span",{class:"form-check-label"},"docker",-1))])])]),e("div",oe,[t[22]||(t[22]=e("label",{class:"form-label required"},"Allow",-1)),e("div",null,[e("label",le,[m(e("input",{class:"form-check-input",type:"radio",name:"allow",value:"allow","onUpdate:modelValue":t[4]||(t[4]=l=>u.value=l)},null,512),[[b,u.value]]),t[19]||(t[19]=e("span",{class:"form-check-label"},"allow",-1))]),e("label",se,[m(e("input",{class:"form-check-input",type:"radio",name:"allow",value:"allow_once","onUpdate:modelValue":t[5]||(t[5]=l=>u.value=l)},null,512),[[b,u.value]]),t[20]||(t[20]=e("span",{class:"form-check-label"},"allow_once",-1))]),e("label",ae,[m(e("input",{class:"form-check-input",type:"radio",name:"allow",value:"deny","onUpdate:modelValue":t[6]||(t[6]=l=>u.value=l)},null,512),[[b,u.value]]),t[21]||(t[21]=e("span",{class:"form-check-label"},"deny",-1))])])]),e("div",re,[t[25]||(t[25]=e("label",{class:"form-label required"},"On/Offline",-1)),e("div",null,[e("label",ne,[m(e("input",{class:"form-check-input",type:"radio",name:"online",value:"true","onUpdate:modelValue":t[7]||(t[7]=l=>o.value.online=l)},null,512),[[b,o.value.online]]),t[23]||(t[23]=e("span",{class:"form-check-label"},"true",-1))]),e("label",ie,[m(e("input",{class:"form-check-input",type:"radio",name:"online",value:"false","onUpdate:modelValue":t[8]||(t[8]=l=>o.value.online=l)},null,512),[[b,o.value.online]]),t[24]||(t[24]=e("span",{class:"form-check-label"},"false",-1))])])]),t[28]||(t[28]=e("div",{class:"mb-3"},[e("label",{class:"form-label required"},"Storage"),e("div",{class:"grid gap-0 column-gap-3"},[e("input",{type:"text",class:"form-control p-2 g-col-11",value:"default",disabled:""})])],-1)),e("div",de,[t[26]||(t[26]=e("label",{class:"form-label required"},"Http",-1)),e("div",ue,[m(e("input",{type:"number",class:"form-control p-2 g-col-11","onUpdate:modelValue":t[9]||(t[9]=l=>r.value=l),disabled:o.value.format!="docker",placeholder:"Enter HTTP port"},null,8,me),[[_,r.value]])])]),e("div",ce,[t[27]||(t[27]=e("label",{class:"form-label required"},"Https",-1)),e("div",pe,[m(e("input",{type:"number",class:"form-control p-2 g-col-11","onUpdate:modelValue":t[10]||(t[10]=l=>d.value=l),disabled:o.value.format!="docker",placeholder:"Enter HTTPS port"},null,8,fe),[[_,d.value]])])])])]),e("div",ve,[e("button",{type:"button",class:"btn btn-link link-secondary","data-bs-dismiss":"modal",onClick:t[11]||(t[11]=l=>v())}," Cancel "),e("button",{type:"button",ref:"submitBtn",class:"btn btn-primary ms-auto",onClick:t[12]||(t[12]=l=>h())},R(s.mode==="new"?"Create":"Update"),513)])])])],512))}}),ye={class:"modal fade",id:"deleteRepository",tabindex:"-1"},ke={class:"modal-dialog modal-lg",role:"document"},we={class:"modal-content"},ge={class:"modal-body text-left py-4"},he={class:"modal-footer"},_e=P({__name:"deleteRepository",props:{repositoryName:{}},emits:["get-repository-list"],setup(w,{emit:k}){const a=C(),p=w,f=k,s=async()=>{const{data:y}=await E("nexus",p.repositoryName);y?a.success("Deleted successfully."):a.error("Failed to delete."),f("get-repository-list")};return(y,i)=>(x(),U("div",ye,[e("div",ke,[e("div",we,[i[3]||(i[3]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),i[4]||(i[4]=e("div",{class:"modal-status bg-danger"},null,-1)),e("div",ge,[i[1]||(i[1]=e("h3",{class:"mb-5"}," Delete Repository ",-1)),e("h4",null,"Are you sure you want to delete "+R(p.repositoryName)+"?",1)]),e("div",he,[i[2]||(i[2]=e("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal"}," Cancel ",-1)),e("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:i[0]||(i[0]=o=>s())}," Delete ")])])])]))}}),Re={class:"card card-flush w-100"},Ne=P({__name:"RepositoryList",setup(w){const k=C(),a=c([]),p=c([]);N(async()=>{y(),await f()});const f=async()=>{try{const{data:r}=await S("nexus");a.value=r}catch(r){console.log(r),k.error("Unable to fetch data.")}},s=c(""),y=()=>{p.value=[{title:"Name",field:"name",width:"15%",cellClick:function(r,d){r.stopPropagation(),s.value=d.getRow().getData().name,M.push("/web/repository/detail/"+s.value)}},{title:"Format",field:"format",width:"10%"},{title:"URL",field:"url",width:"40%"},{title:"Type(hosted)",field:"type",width:"15%"},{title:"Action",width:"20%",formatter:i,cellClick:function(r,d){const v=r.target,h=v==null?void 0:v.getAttribute("id");s.value=d.getRow().getData().name,h==="edit-btn"?o.value="edit":s.value=d.getRow().getData().name}}]},i=()=>`
  <div>
    <button
      class='btn btn-primary d-none d-sm-inline-block me-1'
      id='edit-btn'
      data-bs-toggle='modal' 
      data-bs-target='#repositoryForm'>
      Update
    </button>
    <button
      class='btn btn-danger d-none d-sm-inline-block'
      id='delete-btn'
      data-bs-toggle='modal' 
      data-bs-target='#deleteRepository'>
      Delete
    </button>
  </div>`,o=c("new"),u=()=>{s.value="",o.value="new"};return(r,d)=>(x(),U("div",Re,[g(T,{"header-title":"Repository","new-btn-title":"New Repository","popup-flag":!0,"popup-target":"#repositoryForm",onClickNewBtn:u}),g($,{columns:p.value,"table-data":a.value},null,8,["columns","table-data"]),g(be,{mode:o.value,"repository-name":s.value,onGetRepositoryList:f},null,8,["mode","repository-name"]),g(_e,{"repository-name":s.value,onGetRepositoryList:f},null,8,["repository-name"])]))}});export{Ne as _};
