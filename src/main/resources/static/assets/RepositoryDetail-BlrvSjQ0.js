import{d as C,u as D,a as $,b as t,t as U,h as k,o as x,r as u,e as b,g as f,l as R,i as w,m as V}from"./index-DcNXG3D3.js";import{d as I,u as B,g as L,a as A}from"./repository-Cc2SPYhx.js";import{_ as S}from"./lodash-0vzLorkO.js";import{_ as z}from"./Tabulator.vue_vue_type_style_index_0_lang-Cje3putm.js";import"./request-C5YeUGgG.js";const P={class:"modal fade",id:"deleteComponent",tabindex:"-1"},q={class:"modal-dialog modal-lg",role:"document"},E={class:"modal-content"},T={class:"modal-body text-left py-4"},G={class:"modal-footer"},M=C({__name:"deleteComponent",props:{componentName:{},componentId:{}},emits:["get-detail"],setup(v,{emit:p}){const r=D(),e=v,c=p,i=async()=>{const{data:d}=await I("nexus",e.componentId);d?r.success("Deleted successfully."):r.error("Failed to delete."),c("get-detail")};return(d,a)=>(k(),$("div",P,[t("div",q,[t("div",E,[a[3]||(a[3]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),a[4]||(a[4]=t("div",{class:"modal-status bg-danger"},null,-1)),t("div",T,[a[1]||(a[1]=t("h3",{class:"mb-5"}," Delete Component ",-1)),t("h4",null,"Are you sure you want to delete "+U(e.componentName)+"?",1)]),t("div",G,[a[2]||(a[2]=t("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal"}," Cancel ",-1)),t("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:a[0]||(a[0]=g=>i())}," Delete ")])])])]))}}),K={class:"modal fade",id:"uploadComponent",tabindex:"-1"},j={class:"modal-dialog modal-lg",role:"document"},H={class:"modal-content"},J={class:"modal-body text-left py-4"},O={class:"mb-3"},Q=["value"],W={class:"mb-3"},X=["disabled"],Y={class:"mb-3"},Z={class:"grid gap-0 column-gap-3"},tt={class:"modal-footer"},ot=C({__name:"uploadComponent",props:{repositoryName:{},format:{}},emits:["get-detail"],setup(v,{emit:p}){const r=D(),e=v,c=p;x(()=>{y()});const i=u("/"),d=u([]),a=m=>{d.value=m.target.files[0]},g=async()=>{if(e.format=="raw"&&S.isEmpty(i.value)){r.error("Please enter the path.");return}if(d.value.length==0){r.error("No file selected.");return}const m=new FormData;m.append("assets",d.value),m.append("directory",i.value);const{data:s}=await B("nexus",e.repositoryName,m);s?r.success("Uploaded successfully."):r.error("Failed to upload."),c("get-detail")},y=()=>{i.value="/",d.value=[]};return(m,s)=>(k(),$("div",K,[t("div",j,[t("div",H,[s[7]||(s[7]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),t("div",J,[s[5]||(s[5]=t("h3",{class:"mb-5"}," File Upload ",-1)),t("div",null,[t("div",O,[s[2]||(s[2]=t("label",{class:"form-label"},"Name",-1)),t("input",{type:"text",class:"form-control p-2 g-col-11",value:e.repositoryName,readonly:""},null,8,Q)]),t("div",W,[s[3]||(s[3]=t("label",{class:"form-label"},"Path",-1)),b(t("input",{type:"text",class:"form-control p-2 g-col-11","onUpdate:modelValue":s[0]||(s[0]=_=>i.value=_),disabled:e.format!="raw"},null,8,X),[[f,i.value]])]),t("div",Y,[s[4]||(s[4]=t("label",{class:"form-label required"},"File",-1)),t("div",Z,[t("input",{type:"file",class:"form-control p-2 g-col-11",onChange:a},null,32)])])])]),t("div",tt,[s[6]||(s[6]=t("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal"}," Cancel ",-1)),t("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:s[1]||(s[1]=_=>g())}," Upload ")])])])]))}}),et={class:"card w-100",ref:"workflowForm"},st={class:"card-body"},lt={class:"card-title"},at={class:"mb-3"},nt={class:"grid gap-0 column-gap-3"},dt={class:"mb-3"},it={class:"grid gap-0 column-gap-3"},rt={class:"mb-3"},mt={class:"grid gap-0 column-gap-3"},ut={class:"mb-3"},ct={class:"grid gap-0 column-gap-3"},pt={class:"mb-3"},bt={class:"btn-list"},ft=["disabled"],Dt=C({__name:"RepositoryDetail",setup(v){D();const p=R(),r=V(),e=u({}),c=u([]),i=u([]);x(async()=>{s(),await a()});const d=u(""),a=async()=>{d.value=p.params.repositoryName;const{data:n}=await L("nexus",d.value);e.value=n,await g()},g=async()=>{const{data:n}=await A("nexus",e.value.name);c.value=n},y=u(""),m=u(""),s=()=>{i.value=[{title:"File Name",field:"name",width:"25%"},{title:"File Format",field:"format",width:"15%"},{title:"File URL(Path)",field:"assets",width:"35%",formatter:function(n){const o=n.getValue();return o&&o.length>0?o[0].downloadUrl:"N/A"}},{title:"File Size",field:"assets",width:"15%",formatter:function(n){const o=n.getValue();return o&&o.length>0?`${(o[0].fileSize/1024).toFixed(2)} KB`:"N/A"}},{title:"Action",width:"10%",formatter:_,cellClick:function(n,o){const l=n.target;if((l==null?void 0:l.getAttribute("id"))==="download-btn"){console.log("download");let N=o.getRow().getData();F(N)}else y.value=o.getRow().getData().id,m.value=o.getRow().getData().name}}]},_=()=>`
  <div>
  <button
      class='btn btn-danger d-none d-sm-inline-block'
      id='delete-btn'
      data-bs-toggle='modal' 
      data-bs-target='#deleteComponent'>
      Delete
    </button>
    <button
      class='btn btn-primary d-none d-sm-inline-block me-1'
      id='download-btn'>
      Download
    </button>
  </div>`,F=n=>{const o=n.assets[0].downloadUrl,l=document.createElement("a");l.href=o,l.download="",document.body.appendChild(l),l.click(),document.body.removeChild(l)},h=()=>{r.push("/web/repository/list")};return(n,o)=>(k(),$("div",et,[o[9]||(o[9]=t("div",{class:"card-header"},[t("div",{class:"card-title"},[t("h1",null,"Repository Detail")])],-1)),t("div",st,[t("div",lt,[t("div",at,[o[4]||(o[4]=t("label",{class:"form-label"},"Name",-1)),t("div",nt,[b(t("input",{type:"text",ref_key:"repositoryName",ref:d,class:"form-control p-2 g-col-11","onUpdate:modelValue":o[0]||(o[0]=l=>e.value.name=l),readonly:""},null,512),[[f,e.value.name]])])]),t("div",dt,[o[5]||(o[5]=t("label",{class:"form-label"},"Format",-1)),t("div",it,[b(t("input",{type:"text",ref:"repositoryFormat",class:"form-control p-2 g-col-11","onUpdate:modelValue":o[1]||(o[1]=l=>e.value.format=l),readonly:""},null,512),[[f,e.value.format]])])]),t("div",rt,[o[6]||(o[6]=t("label",{class:"form-label required"},"URL(Path)",-1)),t("div",mt,[b(t("input",{type:"text",ref:"repositoryFormat",class:"form-control p-2 g-col-11","onUpdate:modelValue":o[2]||(o[2]=l=>e.value.url=l),readonly:""},null,512),[[f,e.value.url]])])]),t("div",ut,[o[7]||(o[7]=t("label",{class:"form-label required"},"Type(hosted)",-1)),t("div",ct,[b(t("input",{type:"text",ref:"repositoryFormat",class:"form-control p-2 g-col-11","onUpdate:modelValue":o[3]||(o[3]=l=>e.value.type=l),readonly:""},null,512),[[f,e.value.type]])])]),t("div",pt,[t("div",bt,[t("button",{class:"btn btn-primary d-none d-sm-inline-block",style:{"margin-left":"auto","margin-bottom":"10px"},"data-bs-toggle":"modal","data-bs-target":"#uploadComponent",disabled:e.value.format=="docker"}," File Upload ",8,ft)]),w(z,{columns:i.value,"table-data":c.value},null,8,["columns","table-data"])]),t("div",{class:"row align-items-center"},[o[8]||(o[8]=t("div",{id:"gap",class:"col"},null,-1)),t("div",{class:"col-auto ms-auto"},[t("div",{class:"btn-list"},[t("button",{class:"btn btn-right border",onClick:h}," Back to List ")])])])]),w(M,{"component-name":m.value,"component-id":y.value,onGetDetail:a},null,8,["component-name","component-id"]),w(ot,{"repository-name":e.value.name,format:e.value.format,onGetDetail:a},null,8,["repository-name","format"])])],512))}});export{Dt as default};
