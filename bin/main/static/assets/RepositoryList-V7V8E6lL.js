import{_ as U}from"./TableHeader.vue_vue_type_script_setup_true_lang-DlTbOllV.js";import{_ as D}from"./Tabulator.vue_vue_type_style_index_0_lang-CleTNe4n.js";import{g as P,r as F,u as q,d as L,a as B}from"./repository-8SukfnDm.js";import{d as x,u as $,c as A,w as M,o as V,r as _,a as C,b as e,t as R,e as i,g as w,m as p,h as N,n as S,i as k}from"./index-B0zvEEZV.js";import"./request-BgLFCsdh.js";const T={class:"modal",id:"repositoryForm",tabindex:"-1"},E={class:"modal-dialog modal-lg",role:"document"},G={class:"modal-content"},H=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),I={class:"modal-body text-left py-4"},O={class:"mb-5"},j={class:"row mb-3"},z=e("label",{class:"form-label required"},"Name",-1),J={class:"grid gap-0 column-gap-3"},K={class:"mb-3"},Q=e("label",{class:"form-label required"},"Format",-1),W={class:"form-check form-check-inline"},X=e("span",{class:"form-check-label"},"raw",-1),Y={class:"form-check form-check-inline"},Z=e("span",{class:"form-check-label"},"helm",-1),ee={class:"form-check form-check-inline"},te=e("span",{class:"form-check-label"},"docker",-1),oe={class:"mb-3"},se=e("label",{class:"form-label required"},"Allow",-1),ae={class:"form-check form-check-inline"},le=e("span",{class:"form-check-label"},"allow",-1),ne={class:"form-check form-check-inline"},ie=e("span",{class:"form-check-label"},"allow_once",-1),re={class:"form-check form-check-inline"},ce=e("span",{class:"form-check-label"},"deny",-1),de={class:"mb-3"},me=e("label",{class:"form-label required"},"On/Offline",-1),ue={class:"form-check form-check-inline"},pe=e("span",{class:"form-check-label"},"true",-1),_e={class:"form-check form-check-inline"},fe=e("span",{class:"form-check-label"},"false",-1),ve=e("div",{class:"mb-3"},[e("label",{class:"form-label required"},"Storage"),e("div",{class:"grid gap-0 column-gap-3"},[e("input",{type:"text",class:"form-control p-2 g-col-11",value:"defalut",disabled:""})])],-1),be={class:"mb-3"},he=e("label",{class:"form-label required"},"Http",-1),ye={class:"grid gap-0 column-gap-3"},ke=["disabled"],ge={class:"mb-3"},we=e("label",{class:"form-label required"},"Https",-1),Re={class:"grid gap-0 column-gap-3"},xe=["disabled"],$e={class:"modal-footer"},Ce=x({__name:"repositoryForm",props:{mode:{},repositoryName:{}},emits:["get-repository-list"],setup(y,{emit:b}){const r=$(),n=y,u=b,c=A(()=>n.repositoryName);M(c,async()=>{await l()}),V(async()=>{await l()});const t=_({}),a=_(""),m=_(0),v=_(0),l=async()=>{if(n.mode==="new")t.value.name="",t.value.format="raw",t.value.type="hosted",t.value.url="",t.value.online=!0,a.value="allow";else{const{data:d}=await P("nexus",n.repositoryName);t.value=d,a.value=d.storage.writePolicy,d.format=="docker"&&(m.value=d.docker.httpPort,v.value=d.docker.httpsPort)}},f=async()=>{t.value.storage={blobStoreName:"default",strictContentTypeValidation:!0,writePolicy:a.value},t.value.format!="docker"?t.value.docker=null:t.value.docker={v1Enabled:!0,forceBasicAuth:!0,httpPort:m.value,httpsPort:v.value,subdomain:"/test"},n.mode==="new"?await h().then(()=>{u("get-repository-list")}):await g().then(()=>{u("get-repository-list")}),l()},h=async()=>{const{data:d}=await F("nexus",t.value);d?r.success("등록되었습니다."):r.error("등록 할 수 없습니다.")},g=async()=>{const{data:d}=await q("nexus",t.value);d?r.success("등록되었습니다."):r.error("등록 할 수 없습니다.")};return(d,o)=>(N(),C("div",T,[e("div",E,[e("div",G,[H,e("div",I,[e("h3",O," Repository "+R(n.mode==="new"?"생성":"수정"),1),e("div",null,[e("div",j,[z,e("div",J,[i(e("input",{type:"text",class:"form-control p-2 g-col-11","onUpdate:modelValue":o[0]||(o[0]=s=>t.value.name=s)},null,512),[[w,t.value.name]])])]),e("div",K,[Q,e("div",null,[e("label",W,[i(e("input",{class:"form-check-input",type:"radio",name:"format",value:"raw","onUpdate:modelValue":o[1]||(o[1]=s=>t.value.format=s)},null,512),[[p,t.value.format]]),X]),e("label",Y,[i(e("input",{class:"form-check-input",type:"radio",name:"format",value:"helm","onUpdate:modelValue":o[2]||(o[2]=s=>t.value.format=s)},null,512),[[p,t.value.format]]),Z]),e("label",ee,[i(e("input",{class:"form-check-input",type:"radio",name:"format",value:"docker","onUpdate:modelValue":o[3]||(o[3]=s=>t.value.format=s)},null,512),[[p,t.value.format]]),te])])]),e("div",oe,[se,e("div",null,[e("label",ae,[i(e("input",{class:"form-check-input",type:"radio",name:"allow",value:"allow","onUpdate:modelValue":o[4]||(o[4]=s=>a.value=s)},null,512),[[p,a.value]]),le]),e("label",ne,[i(e("input",{class:"form-check-input",type:"radio",name:"allow",value:"allow_once","onUpdate:modelValue":o[5]||(o[5]=s=>a.value=s)},null,512),[[p,a.value]]),ie]),e("label",re,[i(e("input",{class:"form-check-input",type:"radio",name:"allow",value:"deny","onUpdate:modelValue":o[6]||(o[6]=s=>a.value=s)},null,512),[[p,a.value]]),ce])])]),e("div",de,[me,e("div",null,[e("label",ue,[i(e("input",{class:"form-check-input",type:"radio",name:"online",value:"true","onUpdate:modelValue":o[7]||(o[7]=s=>t.value.online=s)},null,512),[[p,t.value.online]]),pe]),e("label",_e,[i(e("input",{class:"form-check-input",type:"radio",name:"online",value:"false","onUpdate:modelValue":o[8]||(o[8]=s=>t.value.online=s)},null,512),[[p,t.value.online]]),fe])])]),ve,e("div",be,[he,e("div",ye,[i(e("input",{type:"text",class:"form-control p-2 g-col-11","onUpdate:modelValue":o[9]||(o[9]=s=>m.value=s),disabled:t.value.format!="docker"},null,8,ke),[[w,m.value]])])]),e("div",ge,[we,e("div",Re,[i(e("input",{type:"text",class:"form-control p-2 g-col-11","onUpdate:modelValue":o[10]||(o[10]=s=>v.value=s),disabled:t.value.format!="docker"},null,8,xe),[[w,v.value]])])])])]),e("div",$e,[e("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal",onClick:o[11]||(o[11]=s=>l())}," Cancel "),e("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:o[12]||(o[12]=s=>f())},R(n.mode==="new"?"생성":"수정"),1)])])])]))}}),Ne={class:"modal",id:"deleteRepository",tabindex:"-1"},Ve={class:"modal-dialog modal-lg",role:"document"},Ue={class:"modal-content"},De=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Pe=e("div",{class:"modal-status bg-danger"},null,-1),Fe={class:"modal-body text-left py-4"},qe=e("h3",{class:"mb-5"}," Repository 삭제 ",-1),Le={class:"modal-footer"},Be=e("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal"}," Cancel ",-1),Ae=x({__name:"deleteRepository",props:{repositoryName:{}},emits:["get-repository-list"],setup(y,{emit:b}){const r=$(),n=y,u=b,c=async()=>{const{data:t}=await L("nexus",n.repositoryName);t?r.success("삭제되었습니다."):r.error("삭제하지 못했습니다."),u("get-repository-list")};return(t,a)=>(N(),C("div",Ne,[e("div",Ve,[e("div",Ue,[De,Pe,e("div",Fe,[qe,e("h4",null,R(n.repositoryName)+"을(를) 정말 삭제하시겠습니까?",1)]),e("div",Le,[Be,e("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:a[0]||(a[0]=m=>c())}," 삭제 ")])])])]))}}),Me={class:"card card-flush w-100"},Ie=x({__name:"RepositoryList",setup(y){const b=$(),r=_([]),n=_([]);V(async()=>{t(),await u()});const u=async()=>{try{const{data:l}=await B("nexus");r.value=l}catch(l){console.log(l),b.error("데이터를 가져올 수 없습니다.")}},c=_(""),t=()=>{n.value=[{title:"Name",field:"name",width:400,cellClick:function(l,f){l.stopPropagation(),c.value=f.getRow().getData().name,S.push("/web/repository/detail/"+c.value)}},{title:"Format",field:"format",width:300},{title:"URL",field:"url",width:410},{title:"Type(hosted)",field:"type",width:400},{title:"Action",width:400,formatter:a,cellClick:function(l,f){const h=l.target,g=h==null?void 0:h.getAttribute("id");c.value=f.getRow().getData().name,g==="edit-btn"?m.value="edit":c.value=f.getRow().getData().name}}]},a=()=>`
  <div>
    <button
      class='btn btn-primary d-none d-sm-inline-block mr-5'
      id='edit-btn'
      data-bs-toggle='modal' 
      data-bs-target='#repositoryForm'>
      Update
    </button>
    <button
      class='btn btn-danger d-none d-sm-inline-block'
      id='delete-btn'
      data-bs-toggle='modal' 
      data-bs-target='#deleteRepository'>
      Delete
    </button>
  </div>`,m=_("new"),v=()=>{m.value="new"};return(l,f)=>(N(),C("div",Me,[k(U,{"header-title":"Repository","new-btn-title":"New Repository","popup-flag":!0,"popup-target":"#repositoryForm",onClickNewBtn:v}),k(D,{columns:n.value,"table-data":r.value},null,8,["columns","table-data"]),k(Ce,{mode:m.value,"repository-name":c.value,onGetRepositoryList:u},null,8,["mode","repository-name"]),k(Ae,{"repository-name":c.value,onGetRepositoryList:u},null,8,["repository-name"])]))}});export{Ie as default};
